<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Windows Enum</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Windows Enum</h1><br/><p><strong><span style="color:#071ba3;">Winpeas</span></strong></p><p></p><p><a href="https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS">https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS</a></p><p><ol><li>1) <span style="color:#071ba3;">1) Scaricare winpeas.exe</span></li><li><span style="color:#071ba3;">Caricarlo sulla macchina target</span></li><li><span style="color:#071ba3;">Avviarlo</span></li></ol></p><p></p><p><em>(è il corrispettivo di linpeas, ed è in grado di enumerare e trovare vulnerabilità)</em><em></em></p><p><em></em><em></em></p><p><em>-----------------------------------------------------------------------------------------------------------------------</em><em></em></p><p><em>Esempio di utilizzo:</em></p><p></p><p><strong><span style="color:#071ba3;">MACCHINA VULNERABILE “BUTLER”</span></strong></p><p><ol><li>1) <em><span style="color:#071ba3;">1) Una volta trovato il login (si può usare burpsuite o fuff per esempio) e ottenuta una reverse shell con netcat bisogna tentare un privilege scalation;</span></em></li><li><em><span style="color:#071ba3;">Scaricare winpeas.exe e trasferirlo sulla macchina target;</span></em></li><li><em><span style="color:#071ba3;">Avviare winpeas.exe;</span></em></li><li><em><span style="color:#071ba3;">Tra le varie info si trova:</span></em></p><p></li></ol><img src="images/136-1.png" alt="images/136-1.png" /></p><p><em>WiseBootAssistant: un servizio nella cartella Program Files.</em><em></em></p><p><em>Mancano le virgolette nel path --&gt; vulnerabilità (Unquoted Service Path)</em></p><p><img src="images/136-2.png" alt="images/136-2.png" /></p><p></p><p><strong><span style="color:#071ba3;">Come sfruttare la vulnerabilità?</span></strong></p><p><em><span style="color:#071ba3;">a) Creare il payload con msfvenom e dargli il nome corrispondente alla prima parte del nome della cartella</span></em></p><p><img src="images/136-3.png" alt="images/136-3.png" /></p><p><ol><li>2) <em><span style="color:#071ba3;">2) Impostare il listener con netcat (o metasploit)</span></em></li></ol><em><span style="color:#071ba3;"></span></em></p><p><em><span style="color:#071ba3;"></span></em><ol><li><em><span style="color:#071ba3;">Caricare il file nella cartella \Wise in Program x86</span></em></li></ol></p><p></p><p><img src="images/136-4.png" alt="images/136-4.png" /></p><p><ol><li>4) <em><span style="color:#071ba3;">4) Stoppare il servizio WiseBootAssistant</span></em></p><p></li></ol><img src="images/136-5.png" alt="images/136-5.png" /></p><p></p><p><em>Facendo ripartire il servizio, col malware all&#39;interno, otteniamo una shell come amministratore.</em></p><p></p><p></p></div>
</body>
</html>
